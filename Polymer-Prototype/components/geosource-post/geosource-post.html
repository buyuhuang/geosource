<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-item/core-item.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../core-menu/core-submenu.html">
<link rel="import" href="../core-icons/core-icons.html">
<link rel="import" href="../paper-fab/paper-fab.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-dropdown/paper-dropdown.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-menu-button/paper-menu-button.html">
<link rel="import" href="../core-icon/core-icon.html" >
<link rel="import" href="../core-icons/core-icons.html" >
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">

<link rel="import" href="../core-icons/image-icons.html">
<link rel="import" href="../core-icons/av-icons.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../geosource-services/post-service.html">
<link rel="import" href="../paper-radio-group/paper-radio-group.html">

<polymer-element name="geosource-post" attributes="pid">

  <template>

    <style>

      :host {
        width: 500px;
      }

      .header {
        background-color: #5CC0A2;
        margin: 0;
        padding: 20px;
        font-size: 1.8em;
        font-weight: 300;
        color: #FFFFFF;
        max-width: 500px;
      }

      .content {
        padding: 20px;
        max-width: 500px;
      }

      .footer {
        padding: 20px;
        padding-top: 0;
        font-size: 14px;
        color: #636363;
        text-transform: uppercase;
        max-width: 500px;
      }

      video {
        background-color: #000000;
        width: auto;
        height: auto;
      }

      audio {
        width: auto;
      }

      img {
        width: 100%;
        height: auto;
      }

      .checkbox {
        padding: 20px;
        padding-left: 0;
        padding-bottom: 0;
      }

      .checkbox-label {
        padding-left: 15px;
      }

    </style>

    <post-service id="post_service" post="{{post}}" pid="{{pid}}"></post-service>

    <div vertical layout>
      <h2 class="header">{{post.title}}</h2>
      <div class="content" id="content" vertical layout></div>
      <div class="footer">posted by {{post.username}} {{time}} to {{post.channel}}</div>
    </div>

  </template>


  <script>
  Polymer({

    pid: null,
    time: null,
    post: null,

    pidChanged: function() {
      this.$.post_service.load(this.pid);
    },

    postChanged: function() {
      this.time = moment(this.post.time).fromNow();

      content = "";

      for(i=0; i<this.post.fields.length; i++) {

        switch(this.post.fields[i].type) {
          case "Video":
            content += '<h3>' + this.post.fields[i].label + '</h3>';
            content += 
              '<video width="auto" height="auto" controls>' +
                '<source src="' + this.post.fields[i].value + '" type="video/mp4">' +
                'Your browser does not support the video tag.' +
              '</video>';
            break;
          case "Audio":
            content += '<h3>' + this.post.fields[i].label + '</h3>';
            content += 
              '<audio controls>' +
                '<source src="' + this.post.fields[i].value + '" type="audio/mpeg">' +
                'Your browser does not support the audio element.' +
              '</audio>';
            break;
          case "Image":
            content += '<h3>' + this.post.fields[i].label + '</h3>';
            content += '<img src="' + this.post.fields[i].value + '">';
            break;
          case "Text":
            content += '<h3>' + this.post.fields[i].label + '</h3>';
            content += '<div>' + this.post.fields[i].value + '</div>';
            break;
          case "Checkbox":
            content += '<div class="checkbox" horizontal layout><paper-checkbox' 
            if(this.post.fields[i].value) {
              content += ' checked'
            }
            content += ' disabled></paper-checkbox><div class="checkbox-label">' + this.post.fields[i].label + '</div></div>'
            break;
          case "Radio Button":
            content += '<div class="checkbox" horizontal layout><paper-radio-button' 
            if(this.post.fields[i].value) {
              content += ' checked'
            }
            content += ' disabled></paper-radio-button><div class="checkbox-label">' + this.post.fields[i].label + '</div></div>'
            break;


        }
      }

      this.$.content.innerHTML = content;

      this.fire('post-loaded');
    }

  });
  </script>
  
</polymer-element>
