<link rel="import" href="components/polymer/polymer.html">
<link rel="import" href="components/core-item/core-item.html">
<link rel="import" href="components/paper-input/paper-input.html">

<polymer-element name="geosource-channels" attributes="channels">

  <template>

    <style>
      :host {
        display: block;
        position: relative;
        background-color: white;
        width: 100%;
        font-weight: 300;
      }
      paper-input {
        padding-bottom: 10px;
      }
      core-submenu {
        padding: 10px;
      }
      .search {
        padding-right: 10px;
      }
      core-submenu::shadow #submenu {
        margin-left: 15px;
      }
/*      core-item.core-selected {
        color: #3C8670;
      }*/
      .unsubscribe_button {
        color: #FF6666;
      }
      #subscribed {
        padding: 0;
      }
      core-menu {
        margin: 0;
      }
    </style>

    <core-submenu opened active selected="0" icon="settings" label="Channels" on-core-select="{{channelSelected}}">
      <core-menu selected="0">
        <core-item label="All" horizontal center layout selected></core-item>
        <core-submenu id="subscribed" label="Subscribed">
          <template repeat="{{channel in channels}}">
            <div center horizontal layout class="deleteable_channel">
              <core-item label="{{channel.name}}" horizontal center layout flex></core-item>
              <paper-icon-button icon="close" class="unsubscribe_button"></paper-icon-button>
            </div>
          </template>
        </core-submenu>
      </core-menu>
    </core-submenu>
    <div center horizontal layout class="search">
      <paper-icon-button icon="search"></paper-icon-button>
      <paper-input label="Search for channels..."></paper-input>
    </div>
  </template>

  <script>
  Polymer({
    selected: "All",

    /**
     * Fires a 'selection-change' event, and changes the 'selected' attribute to
     * whichever attribute has been selected.
     */
    channelSelected: function(e) {
      this.selected = e.detail.item.label;
      this.fire('filter-change');
    },

    filterPosts: function(posts) {
      var includedPosts = [];
      for(i=0; i<posts.length; i++) {
        if(this.selected == 'All' || posts[i].channel == this.selected) {
          includedPosts.push(posts[i]);
        }
      }
      return includedPosts;
    },
  });
  </script>
  
</polymer-element>
