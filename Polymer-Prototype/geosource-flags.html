<link rel="import" href="components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="components/core-menu/core-submenu.html">

<polymer-element name="geosource-flags">

  <template>
    
    <style>
      :host {
        display: block;
        position: relative;
        background-color: white;
        width: 100%;
        font-weight: 300;
      }
      .toggle_label {
        margin: 15px;
        margin-left: 0;
      }
      core-submenu {
        padding: 10px;
      }
      core-submenu::shadow #submenu {
        margin-left: 15px;
      }
    </style>

    <core-submenu opened active id="core_submenu" icon="flag" label="Flags">
      <div center horizontal layout class="toggle_label">
        <div flex>All</div>
        <paper-toggle-button checked id="all_toggle_button" on-change="{{toggleAll}}"></paper-toggle-button>
      </div>
      <div center horizontal layout class="toggle_label">
        <div flex>Mine</div>
        <paper-toggle-button checked id="mine_toggle_button" disabled on-change="{{toggleMine}}"></paper-toggle-button>
      </div>
      <div center horizontal layout class="toggle_label">
        <div flex>Favorites</div>
        <paper-toggle-button checked id="favorite_toggle_button" disabled on-change="{{toggleFavorites}}"></paper-toggle-button>
      </div>
    </core-submenu>

  </template>

  <script>
    Polymer({

      all: true,
      mine: true,
      favorites: true,

      toggleAll: function(e) {
        var all_toggle = this.$.all_toggle_button;
        var fav_toggle = this.$.favorite_toggle_button;
        var mine_toggle = this.$.mine_toggle_button;

        if(all_toggle.checked) {
          fav_toggle.disabled = true;
          mine_toggle.disabled = true;
        }
        else {
          fav_toggle.disabled = false;
          mine_toggle.disabled = false;
        }

        this.all = all_toggle.checked;
        this.fire('filter-change');
      },
      toggleMine: function(e) {
        var mine_toggle = this.$.mine_toggle_button;
        this.mine = mine_toggle.checked;
        this.fire('filter-change');
      },
      toggleFavorites: function(e) {
        var fav_toggle = this.$.favorite_toggle_button;
        this.favorites = fav_toggle.checked;
        this.fire('filter-change');
      },

      filterPosts: function(posts) {
        var includedPosts = [];
        for(i=0; i<posts.length; i++) {
          if((this.all) || (!this.all && this.favorites && posts[i].favorite)) {
            includedPosts.push(posts[i]);
          }
        }
        return includedPosts;
      },

    });
  </script>

</polymer-element>